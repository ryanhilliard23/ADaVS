import pytest

def test_list_vulnerabilities_stub_message(client):
    r = client.get("/api/vulnerabilities/")
    assert r.status_code == 200
    assert r.json() == {"message": "GET/vulnerabilities/ endpoint hit!"}

def test_vuln_detail_uses_service_but_returns_stub_message(client, monkeypatch):
    from app.services import vulnerability_services
    monkeypatch.setattr(vulnerability_services, "vuln_detail", lambda db, vid: {"id": vid})

    r = client.get("/api/vulnerabilities/5")
    assert r.status_code == 200
    assert r.json() == {"message": "GET/vulnerabilities/5/ endpoint hit"}

def test_list_vulns_for_service_stub_message(client):
    r = client.get("/api/vulnerabilities/service/9")
    assert r.status_code == 200
    assert r.json() == {"message": "GET/vulnerabilities/service/9/ endpoint hit"}
