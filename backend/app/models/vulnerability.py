from sqlalchemy import Column, Integer, String, ForeignKey, Text
from sqlalchemy.orm import relationship
from .base import Base


class Vulnerability(Base):
    __tablename__ = "vulnerabilities"

    id = Column(Integer, primary_key=True, index=True)
    service_id = Column(Integer, ForeignKey("asset_services.id", ondelete="CASCADE"))
    template_id = Column(String, nullable=False)  # e.g., nuclei template identifier
    severity = Column(String)  # info|low|medium|high|critical
    description = Column(Text)  # human-readable summary
    evidence = Column(Text)  # raw evidence/output from scan

    service = relationship("AssetService", back_populates="vulnerabilities")
